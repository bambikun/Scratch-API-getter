<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>Scratchãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæƒ…å ±å–å¾—ãƒ„ãƒ¼ãƒ«</title>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    img { max-width: 200px; }
    .info { margin-top: 10px; }
    input { width: 300px; padding: 5px; }
  </style>
</head>
<body>

<h1>Scratchãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæƒ…å ±å–å¾—</h1>
<p>ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ID ã¾ãŸã¯ URL ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„:</p>
<input type="text" id="projectIdInput" placeholder="ä¾‹: 965887674 ã¾ãŸã¯ https://scratch.mit.edu/projects/965887674">
<button onclick="fetchProject()">å–å¾—</button>

<div id="result" class="info"></div>

<script>
function extractProjectId(input) {
  // æ•°å­—ã ã‘ãªã‚‰ãã®ã¾ã¾è¿”ã™
  if (/^\d+$/.test(input)) return input;

  // URLå½¢å¼ã‹ã‚‰IDã‚’æŠ½å‡º
  const match = input.match(/projects\/(\d+)/);
  return match ? match[1] : null;
}

function fetchProject() {
  const input = document.getElementById("projectIdInput").value.trim();
  const projectId = extractProjectId(input);

  const result = document.getElementById("result");
  result.innerHTML = ""; // ãƒªã‚»ãƒƒãƒˆ

  if (!projectId) {
    result.innerHTML = "<p style='color:red;'>ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆIDãŒç„¡åŠ¹ã§ã™ã€‚</p>";
    return;
  }

  const url = `https://api.scratch.mit.edu/projects/${projectId}`;

  fetch(url)
    .then(res => {
      if (!res.ok) throw new Error("Not found");
      return res.json();
    })
    .then(data => {
      const thumbnailUrl = `https://uploads.scratch.mit.edu/get_image/project/${projectId}_480x360.png`;

      result.innerHTML = `
        <h2>${data.title}</h2>
        <p>ä½œè€…: ${data.author.username}</p>
        <img src="${thumbnailUrl}" alt="ã‚µãƒ ãƒã‚¤ãƒ«"><br>
        <p>â¤ ${data.stats.loves}ã€€â­ ${data.stats.favorites}ã€€ğŸ‘ ${data.stats.views}</p>
        <a href="https://scratch.mit.edu/projects/${projectId}" target="_blank">â–¶ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’è¦‹ã‚‹</a>
      `;
    })
    .catch(err => {
      result.innerHTML = "<p style='color:red;'>æƒ…å ±ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸã€‚</p>";
      console.error(err);
    });
}
</script>

</body>
</html>
